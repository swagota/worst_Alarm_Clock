<!DOCTYPE html>
<html>
<head>
    <title>WAKE UP NOW!!</title>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background: white; 
            font-family: 'Comic Sans MS', cursive; 
            text-align: center;
            transition: filter 0.05s; /* Smooths the strobe slightly */
        }
        #box { padding: 40px; }
        #target-code { 
            font-family: monospace; background: #222; color: #0f0; padding: 20px; 
            font-size: 18px; word-break: break-all; margin: 20px; user-select: none; border: 4px solid #555;
        }
        textarea { width: 80%; height: 80px; font-size: 20px; border: 3px solid black; border-radius: 10px; }
        button { padding: 20px 40px; font-size: 25px; background: red; color: white; cursor: pointer; border: none; border-radius: 15px; font-weight: bold; }
        .messy-emoji { font-size: 150px; display: block; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div id="box">
        <h1 id="main-title" style="font-size: 70px;">ðŸš¨ WAKE UP!! ðŸš¨</h1>
        <p style="font-weight: bold;">TYPE THE CODE BELOW TO STOP THE ALARM:</p>
        <div id="target-code"></div>
        <textarea id="user-input" placeholder="TYPE NOW!!!"></textarea><br><br>
        <button id="stop-btn" onclick="attemptStop()">STOP THE NOISE</button>
    </div>

<script>
    let audioCtx, oscillator, strobeInterval;

    // Start everything immediately
    window.onload = () => { startTheChaos(); };
    // Backup: Start on first click because browsers are strict about audio
    window.onclick = () => { if(!audioCtx) startTheChaos(); };

    function startTheChaos() {
        if (audioCtx) return;

        // 1. SOUND EFFECT (Sawtooth Screech)
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.type = 'sawtooth';
        oscillator.frequency.setValueAtTime(3000, audioCtx.currentTime);
        
        setInterval(() => {
            if(oscillator) {
                oscillator.frequency.exponentialRampToValueAtTime(Math.random() * 4500 + 400, audioCtx.currentTime + 0.05);
            }
        }, 50);

        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        oscillator.start();
        
        // 2. FULL PAGE BLINKING (The Invert Strobe)
        strobeInterval = setInterval(() => {
            document.body.style.filter = document.body.style.filter === "invert(1)" ? "invert(0)" : "invert(1)";
        }, 80);
    }

    function generateCode() {
        const chars = "ABCDEFGHJKLMNOPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz0123456789!@#$%^&*";
        let str = "";
        for(let i=0; i<70; i++) str += chars.charAt(Math.floor(Math.random() * chars.length));
        document.getElementById('target-code').innerText = str;
        document.getElementById('user-input').value = "";
    }

   function attemptStop() {
    const target = document.getElementById('target-code').innerText;
    const input = document.getElementById('user-input').value;

    if (input === target) {
        // 1. KILL THE CHAOS
        clearInterval(strobeInterval);
        document.body.style.filter = "none";
        document.body.style.background = "#ffeef8";

        if (oscillator) {
            oscillator.stop();
            audioCtx.close();
            oscillator = null;
        }

        // 2. PLAY LOCAL AUDIO (Ensure 'morning.mp3' is in the folder!)
        const victoryMusic = new Audio('morning.mp3');
        victoryMusic.play().catch(e => console.log("Audio blocked: ", e));

        // 3. SHOW THE MESSY HEAD CARTOON
    document.getElementById('box').innerHTML = `
    <div style="margin-top: 50px;">
        <div style="font-size: 150px; margin-bottom: 20px;">ðŸ¥±</div> 
        
        <h1 style="color: #ff69b4; font-size: 45px; margin-top: 20px;">Good Morning, Messy Head!</h1>
        <p style="font-size: 20px;">The alarm is silenced. Enjoy your day.</p>
        <br>
        <button onclick="location.href='index.html'" 
                style="background:#ffb6c1; color:black; font-size:18px; border:none; padding:15px; border-radius:10px; cursor:pointer;">
                Start New Eternity?
        </button>
    </div>
`;
    } else {
        alert("WRONG CODE! REGENERATING!");
        generateCode();
    }
}

    generateCode();
</script>
</body>
</html>